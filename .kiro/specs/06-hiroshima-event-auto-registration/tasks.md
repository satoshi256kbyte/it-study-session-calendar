# 実装計画

- [x] 1. ConnpassApiServiceにイベント検索機能を追加
  - connpass APIのイベント検索エンドポイント（/events/）を使用してキーワード検索機能を実装
  - レスポンスデータをConnpassEventData型に変換する機能を実装
  - 既存のレート制限機能を活用して5秒間隔での検索を実装
  - _要件: 1.1, 1.3_

- [x] 2. ConnpassEventData型定義とデータ変換機能を実装
  - connpass APIレスポンス用のConnpassEventData型を定義
  - ConnpassSearchResult型を定義
  - ConnpassEventDataからCreateStudySessionRequestへの変換関数を実装
  - 日時形式の検証とISO変換機能を実装
  - _要件: 1.2, 3.1, 3.5_

- [x] 3. DynamoDBServiceに重複チェック機能を追加
  - イベントURLによる重複チェック機能（checkEventExists）を実装
  - 完全一致文字列マッチングでの重複検出を実装
  - connpassイベントデータからStudySession作成機能を実装
  - エラーハンドリングとログ出力を実装
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 4. HiroshimaEventDiscoveryServiceクラスを実装
  - 広島イベント発見のメインロジックを実装
  - ConnpassApiServiceとDynamoDBServiceを統合した処理フローを実装
  - HiroshimaDiscoveryResult型を定義して結果を構造化
  - 各処理段階での詳細ログ出力を実装
  - _要件: 1.1, 2.1, 3.1, 6.1, 6.2_

- [x] 5. 新規イベント登録と通知機能を実装
  - 重複チェックを通過したイベントの自動登録機能を実装
  - 既存のNotificationServiceを使用した通知送信を実装
  - 通知送信エラー時の処理継続機能を実装
  - 複数イベント登録時の個別通知送信を実装
  - _要件: 3.2, 3.3, 3.4, 4.1, 4.2, 4.3, 4.4_

- [x] 6. batchMaterialsHandlerに広島イベント発見処理を統合
  - 既存のバッチ処理に広島イベント発見処理を追加
  - 広島イベント発見の失敗が既存処理に影響しないエラーハンドリングを実装
  - BatchUpdateResult型を拡張してhiroshimaDiscoveryフィールドを追加
  - 統合レスポンスの生成機能を実装
  - _要件: 5.1, 5.2, 5.4_

- [x] 7. エラーハンドリングとログ機能を実装
  - connpass APIエラー（401, 429, その他）の分類と対応を実装
  - DynamoDBエラーの処理とイベントスキップ機能を実装
  - 通知エラー時の処理継続機能を実装
  - 詳細なエラーログとスタックトレース出力を実装
  - _要件: 1.4, 1.5, 6.3, 6.4_

- [x] 8. 手動実行機能への統合
  - manualBatchUpdate関数に広島イベント発見処理を追加
  - 手動実行時の結果表示に広島イベント発見結果を含める
  - テスト用の手動実行機能を実装
  - _要件: 5.5_

- [x] 9. 単体テストを実装
  - HiroshimaEventDiscoveryServiceの単体テストを作成
  - ConnpassApiService検索機能の単体テストを作成
  - DynamoDBService重複チェック機能の単体テストを作成
  - データ変換機能の単体テストを作成
  - エラーハンドリングの単体テストを作成
  - _要件: 全要件のテストカバレッジ_

- [x] 10. 統合テストを実装
  - バッチ処理統合テスト（既存処理との並行実行）を作成
  - 通知システム統合テスト（NotificationServiceとの連携）を作成
  - エラー時の処理継続テストを作成
  - 統合レスポンス生成テストを作成
  - _要件: 5.1, 5.2, 4.1, 4.2_

- [x] 11. E2Eテストを実装
  - 完全なバッチ実行フローのE2Eテストを作成
  - 広島イベント発見・登録・通知の完全フローテストを作成
  - 重複イベントスキップのE2Eテストを作成
  - エラー回復のE2Eテストを作成
  - _要件: 全要件の統合テスト_

- [x] 12. パフォーマンステストと最適化
  - APIレート制限遵守のテストを実装
  - メモリ使用量とLambda実行時間の測定を実装
  - 大量イベント処理時のパフォーマンステストを実装
  - 必要に応じてパフォーマンス最適化を実装
  - _要件: 6.5, パフォーマンス要件_
